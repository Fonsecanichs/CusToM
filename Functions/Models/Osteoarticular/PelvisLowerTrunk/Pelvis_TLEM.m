function [OsteoArticularModel]= Pelvis_TLEM(OsteoArticularModel,k,Mass,AttachmentPoint)
%   Based on:
%	V. Carbone et al., “TLEM 2.0 - A comprehensive musculoskeletal geometry dataset for subject-specific modeling of lower extremity,” J. Biomech., vol. 48, no. 5, pp. 734–741, 2015.
%   INPUT
%   - OsteoArticularModel: osteo-articular model of an already existing
%   model (see the Documentation for the structure)
%   - k: homothety coefficient for the geometrical parameters (defined as
%   the subject size in cm divided by 180)
%   - Signe: side of the thigh model ('R' for right side or 'L' for left side)
%   - Mass: mass of the solids
%   - AttachmentPoint: name of the attachment point of the model on the
%   already existing model (character string)
%   OUTPUT
%   - OsteoArticularModel: new osteo-articular model (see the Documentation
%   for the structure) 
%________________________________________________________
%
% Licence
% Toolbox distributed under 3-Clause BSD License
%________________________________________________________
%
% Authors : Antoine Muller, Charles Pontonnier, Pierre Puchaud and
% Georges Dumont
%________________________________________________________

%% Variables de sortie :
% "enrichissement de la structure "Human_model""

list_solid={'PelvisSacrum'};

% %% Incrémentation du numéro des groupes
% n_group=0;
% for i=1:numel(OsteoArticularModel)
%     if size(OsteoArticularModel(i).Group) ~= [0 0] %#ok<BDSCA>
%         n_group=max(n_group,OsteoArticularModel(i).Group(1,1));
%     end
% end
% n_group=n_group+1;

%% Incrémentation de la numérotation des solides

s=size(OsteoArticularModel,2)+1;  %#ok<NASGU> % numéro du premier solide
for i=1:size(list_solid,2)      % numérotation de chaque solide : s_"nom du solide"
    if i==1
        eval(strcat('s_',list_solid{i},'=s;'))
    else
        eval(strcat('s_',list_solid{i},'=s_',list_solid{i-1},'+1;'))
    end
end

% trouver le numéro de la mère à partir du nom du point d'attache : 'attachment_pt'
if numel(OsteoArticularModel) == 0
    s_mother=0;
    pos_attachment_pt=[0 0 0]';
else
%     AttachmentPoint=varargin{1};
    test=0;
    for i=1:numel(OsteoArticularModel)
        for j=1:size(OsteoArticularModel(i).anat_position,1)
            if strcmp(AttachmentPoint,OsteoArticularModel(i).anat_position{j,1})
                s_mother=i;
                pos_attachment_pt=OsteoArticularModel(i).anat_position{j,2}+OsteoArticularModel(s_mother).c;
                test=1;
                break
            end
        end
        if i==numel(OsteoArticularModel) && test==0
            error([AttachmentPoint ' is no existent'])
        end
    end
    if OsteoArticularModel(s_mother).child == 0      % si la mère n'a pas d'enfant
        OsteoArticularModel(s_mother).child = eval(['s_' list_solid{1}]);    % l'enfant de cette mère est ce solide
    else
        [OsteoArticularModel]=sister_actualize(OsteoArticularModel,OsteoArticularModel(s_mother).child,eval(['s_' list_solid{1}]));   % recherche de la dernière soeur
    end
end


%%                     Définition des noeuds
%
% TLEM 2.0 – A COMPREHENSIVE MUSCULOSKELETAL GEOMETRY DATASET FOR SUBJECT-SPECIFIC MODELING OF LOWER EXTREMITY
%
%  V. Carbonea*, R. Fluita*, P. Pellikaana, M.M. van der Krogta,b, D. Janssenc, M. Damsgaardd, L. Vignerone, T. Feilkasf, H.F.J.M. Koopmana, N. Verdonschota,c
%
%  aLaboratory of Biomechanical Engineering, MIRA Institute, University of Twente, Enschede, The Netherlands
%  bDepartment of Rehabilitation Medicine, Research Institute MOVE, VU University Medical Center, Amsterdam, The Netherlands
%  cOrthopaedic Research Laboratory, Radboud University Medical Centre, Nijmegen, The Netherlands
%  dAnyBody Technology A/S, Aalborg, Denmark
%  eMaterialise N.V., Leuven, Belgium
%  fBrainlab AG, Munich, Germany
% *The authors Carbone and Fluit contributed equally.
% Journal of Biomechanics, Available online 8 January 2015, http://dx.doi.org/10.1016/j.jbiomech.2014.12.034
% ------------------------- Pelvis ----------------------------------------

% Position du CoM par rapport au repère de centré au milieu RASIS-LASIS
CoM_Pelvis = k*[-0.0484;	-0.0355;	0.0000];

%milieu de RASIS et ASIS dans le repère centré à la hanche droite
Hip_midRASISASIS = k*[0.0338;0.0807;-0.0843];

% Position des noeuds dans le repère centré au milieu de RASIS et ASIS
Pelvis_HipJointRightNode = k*[-0.0338;-0.0807;0.0843]                           - CoM_Pelvis;
Pelvis_HipJointLeftNode = k*[-0.0338;-0.0807;-0.0843]                           - CoM_Pelvis;
Pelvis_HipJointsCenterNode = (Pelvis_HipJointLeftNode+Pelvis_HipJointRightNode)/2-CoM_Pelvis;
Pelvis_SacrumJointNode = k*[0.027 -0.030 0] - CoM_Pelvis;

% ------------------------- Sacrum ----------------------------------------

% Position des noeuds
Sacrum_L5JointNode = k*[0.043 -0.005 0];
% Sacrum_L5JointNode = k*[-65;30;0]/1000- CoM_Pelvis; % Défini à la main sur la géométrie du Sacrum .STL
% Sacrum_PelvisJointNode = k*[0.027 -0.030 0];

Pelvis_L5JointNode = Pelvis_SacrumJointNode'-Sacrum_L5JointNode';


%% Définition des positions anatomiques

Pelvis_position_set= {...
    'RFWT',                     (k*[0;0;0.11770]                 -CoM_Pelvis); ...
    'LFWT',                     (k*[0;0;-0.11770]                -CoM_Pelvis); ...
    'RBWT',                     (k*[-0.1232;-0.000299;0.0373]    -CoM_Pelvis); ...
    'LBWT',                     (k*[-0.1232;-0.000299;-0.0332]   -CoM_Pelvis); ...
    'RightPubicTubercle', ((k*[0.0489;	-0.0032;	-0.0853]-Hip_midRASISASIS)   -CoM_Pelvis); ...
    'LeftPubicTubercle', ([1 0 0;0 1 0;0 0 -1]*(k*[0.0489;	-0.0032;	-0.0853]-Hip_midRASISASIS )  -CoM_Pelvis); ...
    'Pelvis_HipJointRightNode', Pelvis_HipJointRightNode; ...
    'Pelvis_HipJointLeftNode',  Pelvis_HipJointLeftNode; ...
    'Pelvis_LowerTrunkNode',    Pelvis_L5JointNode; ...
    %     'Pelvis_L5JointNode', Pelvis_SacrumJointNode'-Sacrum_L5JointNode'; ...
    'Pelvis_HipJointsCenterNode', Pelvis_HipJointsCenterNode; ...
    'CoMPelvis',                [0; 0; 0]...
    };

Side={{'R';[1 0 0;0 1 0;0 0 1]},{'L';[1 0 0;0 1 0;0 0 -1]}};

for i=1:2 % positions anatomiques des 2 côtés
    Signe=Side{i}{1}; Mirror=Side{i}{2};
    Pelvis_position_set = [Pelvis_position_set;...
        {...
        ['AdductorBrevisDistal1Origin1' Signe 'Pelvis'],Mirror*(k*[0.0231900000000000;-0.0308600000000000;-0.0746800000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorBrevisDistal2Origin1' Signe 'Pelvis'],Mirror*(k*[0.0221200000000000;-0.0326400000000000;-0.0738200000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorBrevisMid1Origin1' Signe 'Pelvis'],Mirror*(k*[0.0282900000000000;-0.0237000000000000;-0.0745600000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorBrevisMid2Origin1' Signe 'Pelvis'],Mirror*(k*[0.0252800000000000;-0.0278800000000000;-0.0748800000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorBrevisProximal1Origin1' Signe 'Pelvis'],Mirror*(k*[0.0367600000000000;-0.0111400000000000;-0.0727800000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorBrevisProximal2Origin1' Signe 'Pelvis'],Mirror*(k*[0.0322000000000000;-0.0182100000000000;-0.0737700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorLongus1Origin1' Signe 'Pelvis'],Mirror*(k*[0.0436800000000000;-0.00617000000000000;-0.0733000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorLongus2Origin1' Signe 'Pelvis'],Mirror*(k*[0.0431300000000000;-0.00708000000000000;-0.0742200000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorLongus3Origin1' Signe 'Pelvis'],Mirror*(k*[0.0426600000000000;-0.00801000000000000;-0.0751600000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorLongus4Origin1' Signe 'Pelvis'],Mirror*(k*[0.0421600000000000;-0.00904000000000000;-0.0760000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorLongus5Origin1' Signe 'Pelvis'],Mirror*(k*[0.0417100000000000;-0.0102600000000000;-0.0769500000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorLongus6Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0415000000000000;-0.0115400000000000;-0.0777500000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusDistal1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0307900000000000;-0.0638700000000000;-0.0415900000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusDistal2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0242700000000000;-0.0644800000000000;-0.0467000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusDistal3Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0118400000000000;-0.0621700000000000;-0.0552600000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusMid1Origin1'	Signe 'Pelvis'],Mirror*(k*[0.00499000000000000;-0.0557800000000000;-0.0576100000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusMid2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.00291000000000000;-0.0602600000000000;-0.0546200000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusMid3Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0104200000000000;-0.0616500000000000;-0.0507200000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusMid4Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0164300000000000;-0.0629800000000000;-0.0462300000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusMid5Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0209900000000000;-0.0644900000000000;-0.0410200000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusMid6Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0251400000000000;-0.0634900000000000;-0.0352600000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusProximal1Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0252300000000000;-0.0301400000000000;-0.0774500000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusProximal2Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0222400000000000;-0.0358500000000000;-0.0732400000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusProximal3Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0198600000000000;-0.0415100000000000;-0.0694400000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['AdductorMagnusProximal4Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0169900000000000;-0.0466000000000000;-0.0655600000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['BicepsFemorisCaputLongum1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0473800000000000;-0.0424700000000000;-0.0261100000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GemellusInferior1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0356200000000000;-0.0164600000000000;-0.0156700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GemellusSuperior1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0482800000000000;-0.00642000000000000;-0.0350400000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMaximusInferior1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0880500000000000;0.0394500000000000;-0.0590000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMaximusInferior2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0846700000000000;0.0355800000000000;-0.0489700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMaximusInferior3Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0894800000000000;0.0237900000000000;-0.0704100000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMaximusInferior4Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0849200000000000;0.0189600000000000;-0.0576200000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMaximusInferior5Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0826700000000000;0.00914000000000000;-0.0765500000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMaximusInferior6Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0798700000000000;0.00892000000000000;-0.0726900000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMaximusSuperior1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0781100000000000;0.121250000000000;-0.0181500000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMaximusSuperior2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0701800000000000;0.119310000000000;-0.0165500000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMaximusSuperior3Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0872300000000000;0.101440000000000;-0.0295600000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMaximusSuperior4Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0766900000000000;0.0951200000000000;-0.0233900000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMaximusSuperior5Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0876600000000000;0.0798900000000000;-0.0372700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMaximusSuperior6Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0799300000000000;0.0766700000000000;-0.0304400000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMediusAnterior1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0243500000000000;0.103680000000000;0.0295900000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMediusAnterior2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0227000000000000;0.111280000000000;0.0397700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMediusAnterior3Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0106800000000000;0.0943400000000000;0.0358700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMediusAnterior4Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.00856000000000000;0.103070000000000;0.0455900000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMediusAnterior5Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0100400000000000;0.0900500000000000;0.0374200000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMediusAnterior6Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0111300000000000;0.0956000000000000;0.0445900000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMediusPosterior1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0501100000000000;0.125950000000000;0.00349000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMediusPosterior2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0372200000000000;0.113080000000000;0.0147700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMediusPosterior3Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0605400000000000;0.110290000000000;-0.0155000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMediusPosterior4Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0410500000000000;0.0966400000000000;-0.00228000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMediusPosterior5Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0648200000000000;0.0830900000000000;-0.0192700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMediusPosterior6Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0499000000000000;0.0745400000000000;-0.0124700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMinimusAnterior1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.00824000000000000;0.0843300000000000;0.0291700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMinimusAnterior2Origin1'	Signe 'Pelvis'],Mirror*(k*[0.00941000000000000;0.0689400000000000;0.0253200000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMinimusMid1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0270100000000000;0.0745700000000000;0.00448000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMinimusMid2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0100500000000000;0.0518600000000000;0.0127700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMinimusPosterior1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0377400000000000;0.0521500000000000;-0.00660000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['GluteusMinimusPosterior2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0263900000000000;0.0337400000000000;0.00345000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['Gracilis1Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0136000000000000;-0.0491900000000000;-0.0646600000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['Gracilis2Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0245700000000000;-0.0305400000000000;-0.0761400000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['IliacusLateralis1Origin1'	Signe 'Pelvis'],Mirror*(k*[0.00931000000000000;0.0938600000000000;0.0306500000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['IliacusLateralis1Via2'	Signe 'Pelvis'],Mirror*(k*[0.0184900000000000;0.0308900000000000;-0.00155000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['IliacusLateralis2Origin1'	Signe 'Pelvis'],Mirror*(k*[0.00122000000000000;0.0662400000000000;0.00993000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['IliacusLateralis2Via2'	Signe 'Pelvis'],Mirror*(k*[0.0184900000000000;0.0308900000000000;-0.00155000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['IliacusMedialis1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0413800000000000;0.123230000000000;0.00677000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['IliacusMedialis1Via2'	Signe 'Pelvis'],Mirror*(k*[0.0184900000000000;0.0308900000000000;-0.00155000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['IliacusMedialis2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0441700000000000;0.102430000000000;-0.0162900000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['IliacusMedialis2Via2'	Signe 'Pelvis'],Mirror*(k*[0.0184900000000000;0.0308900000000000;-0.00155000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['IliacusMid1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0204400000000000;0.105740000000000;0.0268400000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['IliacusMid1Via2'	Signe 'Pelvis'],Mirror*(k*[0.0184900000000000;0.0308900000000000;-0.00155000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['IliacusMid2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0244900000000000;0.0765800000000000;-0.00223000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['IliacusMid2Via2'	Signe 'Pelvis'],Mirror*(k*[0.0184900000000000;0.0308900000000000;-0.00155000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorExternusInferior1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0127000000000000;-0.0400400000000000;-0.0459900000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorExternusInferior2Origin1'	Signe 'Pelvis'],Mirror*(k*[0.00143000000000000;-0.0412100000000000;-0.0550000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorExternusSuperior1Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0233800000000000;-0.00470000000000000;-0.0524100000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorExternusSuperior2Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0264100000000000;-0.0123900000000000;-0.0635500000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorExternusSuperior3Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0299500000000000;-0.0207600000000000;-0.0737700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorInternus1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.00230000000000000;0.0269700000000000;-0.0275600000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorInternus1Via2'	Signe 'Pelvis'],Mirror*(k*[-0.0454800000000000;-0.0187000000000000;-0.0312100000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorInternus2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0256800000000000;0.0236100000000000;-0.0237400000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorInternus2Via2'	Signe 'Pelvis'],Mirror*(k*[-0.0454800000000000;-0.0187000000000000;-0.0312100000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorInternus3Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0166400000000000;0.00353000000000000;-0.0445000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorInternus3Via2'	Signe 'Pelvis'],Mirror*(k*[-0.0454800000000000;-0.0187000000000000;-0.0312100000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorInternus4Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0269300000000000;-0.00750000000000000;-0.0346400000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorInternus4Via2'	Signe 'Pelvis'],Mirror*(k*[-0.0454800000000000;-0.0187000000000000;-0.0312100000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorInternus5Origin1'	Signe 'Pelvis'],Mirror*(k*[0.00540000000000000;-0.0341400000000000;-0.0610700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorInternus5Via2'	Signe 'Pelvis'],Mirror*(k*[-0.0454800000000000;-0.0187000000000000;-0.0312100000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorInternus6Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0249800000000000;-0.0340500000000000;-0.0408500000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['ObturatorInternus6Via2'	Signe 'Pelvis'],Mirror*(k*[-0.0454800000000000;-0.0187000000000000;-0.0312100000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['Pectineus1Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0160000000000000;0.0240400000000000;-0.0290700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['Pectineus2Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0220600000000000;0.0154500000000000;-0.0354800000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['Pectineus3Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0283200000000000;0.00760000000000000;-0.0427200000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['Pectineus4Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0358900000000000;0.000550000000000000;-0.0498200000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['Piriformis1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0715700000000000;0.0579000000000000;-0.0566800000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['PsoasMajor1Via1' Signe  'Pelvis'],Mirror*(k*[0.0134900000000000;0.0328900000000000;-0.00155000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['PsoasMajor2Via1' Signe  'Pelvis'],Mirror*(k*[0.0134900000000000;0.0328900000000000;-0.00155000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['PsoasMajor3Via1' Signe  'Pelvis'],Mirror*(k*[0.0134900000000000;0.0328900000000000;-0.00155000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['PsoasMajor4Via1'	Signe 'Pelvis'],Mirror*(k*[0.0134900000000000;0.0328900000000000;-0.00155000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['PsoasMajor5Via1' Signe  'Pelvis'],Mirror*(k*[0.0134900000000000;0.0328900000000000;-0.00155000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['QuadratusFemoris1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0248500000000000;-0.0362300000000000;-0.0170300000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['QuadratusFemoris2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0223000000000000;-0.0442800000000000;-0.0210400000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['QuadratusFemoris3Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0215400000000000;-0.0526300000000000;-0.0269400000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['QuadratusFemoris4Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0217100000000000;-0.0607200000000000;-0.0322300000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['RectusFemoris1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.00784000000000000;0.0343300000000000;0.0112700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['RectusFemoris2Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0207300000000000;0.0428000000000000;0.0161300000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['Sartorius1Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0319500000000000;0.0786100000000000;0.0326100000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['Semimembranosus1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0383200000000000;-0.0276100000000000;-0.0154800000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['Semimembranosus2Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0340100000000000;-0.0429800000000000;-0.0149000000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['Semimembranosus3Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0271000000000000;-0.0567700000000000;-0.0243900000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['Semitendinosus1Origin1'	Signe 'Pelvis'],Mirror*(k*[-0.0431600000000000;-0.0572600000000000;-0.0344700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['TensorFasciaeLatae1Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0224900000000000;0.0915500000000000;0.0467700000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        ['TensorFasciaeLatae2Origin1'	Signe 'Pelvis'],Mirror*(k*[0.0294200000000000;0.0861400000000000;0.0426600000000000]-Hip_midRASISASIS)-CoM_Pelvis;...
        }]; %#ok<AGROW>
end

%%                     Mise à l'échelle des inerties

    %% ["Adjustments to McConville et al. and Young et al. body segment inertial parameters"] R. Dumas
    % ------------------------- Pelvis ----------------------------------------
    Length_Pelvis = norm(Pelvis_HipJointsCenterNode-Sacrum_L5JointNode);
    [I_Pelvis]=rgyration2inertia([100 107 95 25*1i 12*1i 8*1i], Mass.Pelvis_Mass, [0 0 0], Length_Pelvis);

%% Création de la structure "Human_model"

num_solid=0;
%% Pelvis
% Pelvis
num_solid=num_solid+1;        % solide numéro ...
name=list_solid{num_solid}; % nom du solide
eval(['incr_solid=s_' name ';'])  % numéro du solide dans le modèle
OsteoArticularModel(incr_solid).name=name;               % nom du solide
OsteoArticularModel(incr_solid).sister=0;                      % sister
OsteoArticularModel(incr_solid).child=0;       % child
OsteoArticularModel(incr_solid).mother=s_mother;                      % mother
OsteoArticularModel(incr_solid).a=[0 0 0]';                    % axe de rotation
OsteoArticularModel(incr_solid).joint=1;                       % type d'articulation : 1:pivot / 2:glissière
OsteoArticularModel(incr_solid).calib_k_constraint=[];         % initialisation des contraintes d'optimisation pour la calibration de la longueur des membres
OsteoArticularModel(incr_solid).u=[];                          % rotation fixe selon l'axe u d'un angle theta (après la rotation q)
OsteoArticularModel(incr_solid).theta=[];
OsteoArticularModel(incr_solid).KinematicsCut=[];              % coupure cinématique
OsteoArticularModel(incr_solid).ClosedLoop=[];                 % si solide de fermeture de boucle : {numéro du solide i sur lequel est attaché ce solide ; point d'attache (repère du solide i)}
OsteoArticularModel(incr_solid).ActiveJoint=1;                 % 1 si articulation active / 0 si articulation passive
OsteoArticularModel(incr_solid).Visual=1;                      % 1 si il y a un visuel associé / 0 sinon
OsteoArticularModel(incr_solid).Geometry='TLEM';
% OsteoArticularModel(incr_solid).Group=[n_group 1];                   % groupe pour la calibration dynamique
OsteoArticularModel(incr_solid).b=pos_attachment_pt;                    % position du point d'attache par rapport au repère parent
OsteoArticularModel(incr_solid).c=[0 0 0]';                    % position du centre de masse dans le repère local
OsteoArticularModel(incr_solid).m=Mass.Pelvis_Mass;                 % masse
OsteoArticularModel(incr_solid).I=[I_Pelvis(1) I_Pelvis(4) I_Pelvis(5); I_Pelvis(4) I_Pelvis(2) I_Pelvis(6); I_Pelvis(5) I_Pelvis(6) I_Pelvis(3)];                  % matrice d'inertie de référence
OsteoArticularModel(incr_solid).anat_position=Pelvis_position_set;
OsteoArticularModel(incr_solid).linear_constraint=[];
OsteoArticularModel(incr_solid).L={'Pelvis_HipJointsCenterNode';'Pelvis_LowerTrunkNode'};
OsteoArticularModel(incr_solid).v= [] ;

end
